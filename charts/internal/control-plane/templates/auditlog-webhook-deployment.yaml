{{- if .Values.auditlogWebhook.enabled }}
---
# Probably shouldnt need this when all is in place:
# apiVersion: v1
# data:
#   ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVDVENDQXZFQ0ZDdkk3cjE2SWkwNzJ0Ukp5djZIbFNQZFo5N2NNQTBHQ1NxR1NJYjNEUUVCRFFVQU1JSEEKTVFzd0NRWURWUVFHRXdKRVJURVFNQTRHQTFVRUNBd0hRbUYyWVhKcFlURVFNQTRHQTFVRUJ3d0hRbUYyWVhKcApZVEVPTUF3R0ExVUVFUXdGT0RVMU5EQXhJVEFmQmdOVkJBa01HRkpwWTJoaGNtUXRVbVZwZEhwdVpYSXRRV3hzClpXVWdPREVPTUF3R0ExVUVDZ3dGUmtrdFZGTXhGVEFUQmdOVkJBc01ER05zYjNWa0xXNWhkR2wyWlRFUk1BOEcKQTFVRUF3d0labWt0ZEhNdWFXOHhJREFlQmdrcWhraUc5dzBCQ1FFV0VXNXZMWEpsY0d4NVFHWnBMWFJ6TG1sdgpNQjRYRFRJd01EUXlNakUzTkRVME5Gb1hEVEl3TURVeU1qRTNORFUwTkZvd2djQXhDekFKQmdOVkJBWVRBa1JGCk1SQXdEZ1lEVlFRSURBZENZWFpoY21saE1SQXdEZ1lEVlFRSERBZENZWFpoY21saE1RNHdEQVlEVlFRUkRBVTQKTlRVME1ERWhNQjhHQTFVRUNRd1lVbWxqYUdGeVpDMVNaV2wwZW01bGNpMUJiR3hsWlNBNE1RNHdEQVlEVlFRSwpEQVZHU1MxVVV6RVZNQk1HQTFVRUN3d01ZMnh2ZFdRdGJtRjBhWFpsTVJFd0R3WURWUVFEREFobWFTMTBjeTVwCmJ6RWdNQjRHQ1NxR1NJYjNEUUVKQVJZUmJtOHRjbVZ3YkhsQVpta3RkSE11YVc4d2dnRWlNQTBHQ1NxR1NJYjMKRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEamtQeDQvQ3NNZTY5eElUOWlnald1bWwvQzlTalp3TXBKUXVmNwpzMXRZT08vVUUyQ1Uyb1JMN0xtSS9Cak12NHY4dmt1TytLZ1V2OXhPcGc1aWxJclNzZjFtTjF0blptd3Q2UnV4CitSZWN0ZFhHNXJlbTFjSUdsNEh0MEhsNTl2eVIyMVV2L0dORElacnNEVm5CREV4OWpQTFVNd0dPeW9rOG1pUVYKYld2Umx1V2dJeTFlR3g0OGcwRDhqRVBJMWttNGVaQzNWRGJ0Rnc1bVRzVDJEOXVja2tHbU1FcXNLdTdzV1pQTQpZdEF5a1ZMTEJEOTg5cXlzVjJrYUNmNEptV1RBMVVpT0RQR0FDL0Q3UDJVM1EvalB6dDFERlpUbHhzR2FDZ0JiClA2NmtSNEowZ0kyZmc3N1ZGeCtjQVJRWDdsUnY4VGJadENESnJLNFk1MmdIUnAvQkFnTUJBQUV3RFFZSktvWkkKaHZjTkFRRU5CUUFEZ2dFQkFHQUJ2SUdQTjgwYXBIYmdYQ2lrRGFvOWQ0bTE0M3ZRbkhtNHZkellGc2o4bjR0dgp4SEtPSWwreTdvdlRNVEJmdGJCUWNRUDR5VUVOS05iSG4rZFBOREZyL3ltZTUvQUdMM2RROXVoMXJtREpsSGk4CkJNbzhFYkVxMzMvSXFLVm55dEQzby9vYklzTjgvdFBSWGo4RUprWG5nMkpaNW5mRjZvaTRtK1RwTlJIQnNLRFAKT2xiUHRpYm9od2ZGT0hTOEtQMmhVWDRJQ2Q5MlI1YitsSnNYYTh4Q0VQdlhzaGF1RXpXcWIzS28xdUlIbitKagp3WFBTSDltLzBPWjIrK3pyVERaNzByVFBxd0hGTjB1eUNTK0t3b3hFbVR0UnVobnNGQXZsU2JFTmdQbEJXRmpECjFxYlJKSGxpWllYY2JTU3VHdU1sMGVheElBWFlZRWRGTDEzYW5GST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
#   splunk-audit-webhook-server.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURkekNDQWw4Q0ZEMzF5TmlnT1Nwb3lFdlBFVkJ2djQya0gvMjNNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1JSEEKTVFzd0NRWURWUVFHRXdKRVJURVFNQTRHQTFVRUNBd0hRbUYyWVhKcFlURVFNQTRHQTFVRUJ3d0hRbUYyWVhKcApZVEVPTUF3R0ExVUVFUXdGT0RVMU5EQXhJVEFmQmdOVkJBa01HRkpwWTJoaGNtUXRVbVZwZEhwdVpYSXRRV3hzClpXVWdPREVPTUF3R0ExVUVDZ3dGUmtrdFZGTXhGVEFUQmdOVkJBc01ER05zYjNWa0xXNWhkR2wyWlRFUk1BOEcKQTFVRUF3d0labWt0ZEhNdWFXOHhJREFlQmdrcWhraUc5dzBCQ1FFV0VXNXZMWEpsY0d4NVFHWnBMWFJ6TG1sdgpNQjRYRFRJd01EUXlNakUzTkRVME5Gb1hEVEl3TURVeU1qRTNORFUwTkZvd0x6RXRNQ3NHQTFVRUF3d2tjM0JzCmRXNXJMV0YxWkdsMExYZGxZbWh2YjJzdWEzVmlaUzF6ZVhOMFpXMHVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEIKQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBcGVqUmhlVkpvMGdFd3NFVTl4dmZUVDBOVUhlamp0Q0ZKQnhlWVEwSwpQWDVESnNtVXMvbFA4U2dYcTREczhNRkhqdUVyME9vbno5c1N5UzRWNGtMbjg1L0lhMlpiTGM1ZDZjUFRRdGxhCmVoYmpMVDdJREtIMy8yeW5IclcvUzBsNDVwVHdFSU1qTWpkK20wZlB0UzhQTVV0eGRzMmtieWpoOExMcS9IbHYKTkoraFdMWGxiM2JGNm8xT0FlRmtwUmZZdEtiV1Rtd29CQ3BUemRCcDdWY1B6NXVmMVhGQmhocFZEcXorOGZoegowMmJqbkVLem5ocHl3UDBaQ3Q5TjF5Z0NicTRRYndwRHV1MmZicGFIck5nVk9GYXJweWh0NWQ2WDI5MEYybXVjCk5ZdG5wRzh4OTV3U1RRMWxhVnM1YnRMa2xrdU8wU1RKWEV3Tkh6UDJGOUdSQXdJREFRQUJNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFEWFJzam5LRTJLM1hKZjIyVGVzcUcxUmZPZ0FJNHM0UDhnRDlsTytWV2N2TS9yb3I2KwphTTBGMzJOY0dvTCtlMWFOOXNWNDQvbHpMWEVXZ1lTbEV6dk9OS0pObU91dHI0OGFreG1nVXRST2Y1MVJLeDdLClE1OG5jeHlNWG83OWRuZzExajR5RXd0ME9OaGxBUnVUcjRYN2RWT0VoYTM3RWt1bDBCY08zd1dCS0xJaFh6L0gKR1FnMjljRnFwbjR1SUZDN292YkFKV2hDSFY5ZkFjNHJzdUNZcWdmVjFFNVZtL010QnFzdFRoUlh6V04xeUpZOQpXRkhlUGZwVlpudjFmdHF3WUN0ckpEbTdkNzAxVmIvOFFtdWFCY2ZGSy94UjZQQnlQaTV3bFpDU1U3RlVUeklWCmNDRk1DV3BaREhza281ZlJmenlCUG9TZUUrOVpwYTRMTmovMgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
#   splunk-audit-webhook-server.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBcGVqUmhlVkpvMGdFd3NFVTl4dmZUVDBOVUhlamp0Q0ZKQnhlWVEwS1BYNURKc21VCnMvbFA4U2dYcTREczhNRkhqdUVyME9vbno5c1N5UzRWNGtMbjg1L0lhMlpiTGM1ZDZjUFRRdGxhZWhiakxUN0kKREtIMy8yeW5IclcvUzBsNDVwVHdFSU1qTWpkK20wZlB0UzhQTVV0eGRzMmtieWpoOExMcS9IbHZOSitoV0xYbApiM2JGNm8xT0FlRmtwUmZZdEtiV1Rtd29CQ3BUemRCcDdWY1B6NXVmMVhGQmhocFZEcXorOGZoejAyYmpuRUt6Cm5ocHl3UDBaQ3Q5TjF5Z0NicTRRYndwRHV1MmZicGFIck5nVk9GYXJweWh0NWQ2WDI5MEYybXVjTll0bnBHOHgKOTV3U1RRMWxhVnM1YnRMa2xrdU8wU1RKWEV3Tkh6UDJGOUdSQXdJREFRQUJBb0lCQUhTeTZQMzNvKzVZTUJFVgpZenZWdlNKRk9XSktaUitGaU1FM3V5TWsydmthSVAzZGVOMkhGallZNzExUldGaVllMDhERDZEcHM0cy9HMTJyCkx2VngvbG1kSUlwNit0T2pmdWQ1T05haXNFT0VhZE5mZjdOekVrLzJDeTlNdy91ZStJMm9ZWndid2R3R3NPVmsKZzdOOElJR2FBWHVCZHBKQi9Yc2pQcXJNZCs1WTREWDhxVHd1dE00SDk3R09XZlh2Q0VHamp3Z051T0ZwbTZYNwpsbEltbTA0aTBZSzRSUWt0eG9BdUYwWEVVV25uZ2hQY2FxZUJnUWlQVExIRkxsdHVYK1A3bTd6bmRFYmdaNnB2Cit3KzNtYUc2a2sxUmpqV3FWeWtycWVWUGpTSDlJTkMvODRjWHp6aGdyRWZid0FuSkFleVY0MXMxQTl6N3pqYUMKZ0g0ekNwRUNnWUVBMVp6TSt0KzBNUHBpcFZPd2M4YndZZlVMTnNBR1JNVjk4Zk9TQ1NvR2t6Y2ZseHZBT2k1ZQpKRmMxK2RpN1IrVjVQVHdBdDc3ekRQNTlBaUI4Vk9yVFVxanoyZytoSjNRZjQ2YU1pNmZnL3pwK2VyZVFUNE9nClE1ZUJjbG8vaWx0TmxJdThPOVdobFFZY01GVitFeHdVK3pMN3F2VXk3WHptUExCOTFka2R0WDhDZ1lFQXh0VEYKNXFMZE13Rnh5Y2dBeU53UGdXaEJFT2NybFVJRGgvdjlnME1VNFRKWWo1NmkrdDkwazFzczZ5ZHAyUHVZZTdmbwozeEovNTRVVCt2Y0p0TjVhdTRLZmdJMU82Z1EvZ2g4WWlYL0h1dkVsK01JckZnd0I1MXRTYXhQbE1lakJzTnJmCjRDNFErcFVxOVhvdDVZRzA0aXU1Ulg0aWlLN1VZdlpkbHBzZERuMENnWUJhMGdmMHdoZ0NtdkpHQ0ljRk1wZ1IKamZYdW1VWVJCMGE5RUNvTzYyZFFRQ2VXUDU1REhtTzRYN3Y3TmtLcUZzNnRVazJiMGZ2VWtuN2o0SnY4SHJzcQpjZHI3NDVsSkJQNXA4KzNka3NyK3VRZjlkUDVPVUZCYmJKY0UzNG9VY1MxUzh2WmRHajlROVFBWExNSWxyZExkCjJwZFY0RnArenBPMVNmUzJiMUZLVVFLQmdEU0hUZWxLcWFtcC9nZlRBUElQd1VEczdCT3RId1NGdGkwYzA3THoKNi9ZNnVNN29tQ0l6R3JjN1pUaVM1eEhlRmtESks0cVRkcHNSdTErWUdFWmlZQklkeGtuT0MwVWo3aXRRVDhregpxdTZtZXVPbldINndtV2duNWpSSHcwdFdOS1dtalhMS2VNM2F6c2lmaUxTVGVkZ3V1UG0xQXlhZEdac3pmeklrCnRKNTVBb0dBUXk5Wk9hSTMrQ0VwOC9wbGlkM2JSWWROM3Z6NmhmOWMvaGJJQzJ4QzhOMmVnTnJXK3Y0OWxac3IKZEd4NEhFd0lReHJZQURsSlZFOFgwUTcrUE45KzEwd0c5NzZNemMyWW96SkMyTWxHdDdhT1JJODVmV2FkaVQ1RwppWUZKRVFVaHBEVUEvdXdIRTE1akhYSm5taG03bWJINVhNcTdkYUpnL3ZwdkZzdDNDQUk9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
#   splunk-client.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRUUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1Nzd2dna25BZ0VBQW9JQ0FRREpjWjVQdURodzZUMHcKeUxUbXFTNUpLQVlkcVFMUmp0b081SDRkZ0Z1NkE3Q1hPc1diOHdObU9EOHE5c1dkTThsa25DUnZUYTEzME1FRgpQR3U0Z0hmakFKVkhLbkFDQ3E2Vjd4V3NwbFFoczk0SUtYVmNNS1BrejRwV2VMbWprZU1CK1VzV1VDNEZCYlFpCkhUSi9sRk1uUmRtNzB5aFVVcmhGS1R1VWQ3clNrM3Q4R0JweVJ6WXUvSHpMdHZwK21zOWxlWW9tTnR4TzlxNDAKdStZRWdqS2pZbnFDcFVTSTR1UFN5OFR2bmFsY0RtQ01ZK3JudGxxNFBRbjdGVUJpZE5wWUhqS0g1QS8vR1ByUwo1N0twaEt5ZWt5SnVyK2FraVRLTG1ramszMzhOVDcyTzNxYTRJWmFrd0NickhPQk5sKzkyUWVVWUtXTVA1NEZxCnNuNnFqTEFaWlhJMDdkSXRTeS84L0lJWEQxaWNwcHBoeExsVy8zTGlaTVRqSGhmUzQrVUVMOXpUbVFWaGFkY0QKbldPMVd3RzA0elEza0VIM2tJV0NMeXNtZ0dtVUs5WENJZ2VGSEN5R0FlOFgwZXBHVmVYeUtsb2t3YWVpRG5WUgo0ei80cDlqNjZDTk50N2xzV3ZYcENGcnlrL3U4WG1RTkllS2t5dlRtWFIrRW1uU2J1NERQTVlFRTlwVGZJQTVRCjhMd3F1clNxeTRyWkVTU09ZSWlKWkZzT3BFZ3hmREVFVURhSXRXLzZiOVdZYjlrTUZNVnZpTk00ZlZLU2JpaHYKYU1oTTh5dVFXMERRZEdoMlo4V0Y5dU8zL1c2bXFDc0NOOEhBSmZDVUVtNmVTbDZ3MzAvRkdEd2Y1TjBHRFdYNAp6TDdDSGYwZ2tLdFcrTmlCNy9VeitrM0x1NDlMa1FJREFRQUJBb0lDQUhEZUtFV2lnbjFCTWZmVGZRaUFZbDY2Ci9qSkFNRVFhTmpPQjh1ZTBzN0JWd092N0VoMSsyN2k2YXlvM2VpSEtrbHk4MyswOUtLU3BZbno4alo2aTNJbGsKR2ovMWx5eU5yNlJ5Z1VKckwxaHkzMFRUZGQ1aG9uTGhsakU5RTBhQ3h4NmovMTVSTG5mQjZsdnk0QWg3b3R1dQpWNERWbnhNZ0JmODZTeGUwdmdpZWVlSGQzM09JVXVPZ3RJdXZ5a3FGa3c3WU9uK08zWUdnMVpyV2JOcTUySVdTCjkvR2JoL3JxcFp2R2NHR1JoUUwvU3psZUFwQXhyRUx1Y0ZrdVh4VExSRXQ3SC9UajQ5S2F2RzdQUTF1WDZ1QXUKc0d3MFFwYU9DTFFQamlndTBaRXp6Skh3VHBsOHVGczNEcGROWnFBVE1TaWhZeXRXaFJxMEs5OE1nOHdyWjc3VApIbXhyNTE1OHpueVQ1aytHUnRoVyt3TzJySGRnRm1BVnd6bG5hSWFtWDcvaXlVRnM2b3FXd0hhYlV6OVEyQ1k2CitkOGNielhRbXgrZE8yMCtPOFIwSmV1VXlXcitaS0ZOZTNoTlNFRTd2VTBFRlZPRW9sQWROaEZWVks2TFNKSmUKMlB6VVYwYzhIeWxFSmp5aFBsQkFudDZQZ2w0NmQvekxHRFhqdk5xSnhmRXZ2TW9hOVFTTnlNOTJWUW9rZ0FxWApYWkRjMkVXbG1MeSsrbHdwVHNpMHFwUmJTK3hnSFhBeER2SE4rWmRkU3NYaHl4aXJIS1ZIaGQ3MkhhOEdhSmYzCnJzYlNTbE05UXErYzRxZWFMSDFtWTZ2SGl6Tm84VGhUY0FldSsrUUVZenljOGpXUEQ5dlNFKzZqd1lJRkdkMEsKeGRYM29FeVJBN2hNTFFrY2hDQUJBb0lCQVFEOGg5ODh5T2ZaTk9NMHZlMThPQ2xpaURBbUtMNUxoSG9CekxTZwpoQk1MU2p0NHlMM0UrY01nN0MzazMzWG5Scnlrb28rNXEvancyVDdGdG53bUdwbjNvK0dJOVAzeW93aTg1YW0yCks2MXJkSGpTakhuc0ZhU0NQcGxpY0tFYlAxZWVpRnczRlN0QnVYODl2VUZUTGtYelQ0bTV3aUlpaUVscWRDd2cKSE5ybWJIc3pJTndWR3N0T1JONzVrRGNQd21XenpFSC9xMXdqOXVCb1VaeEhUcFFuYm9kZGozbFR4WldTTGR6YQpiVzk3TEdMdTNFQU12RDZJbmFRUWdLbE9ENTczRFBCWlp1UG1JOFNPd3UwZDB2bDlmVUUrc2lnYXN1SlhxL2NwCm5xN0s0eWNQb1BsV0FwWUs3dndEMlViOU0vUkpKS0xlOWxHbUc2TzdvOXdpak9CeEFvSUJBUURNTmhRSHJvTGcKNFNnS3JKb21ObTlENzZhN1Y3aWhHSFd3Qm5jbEcyZGxxckVNcnNWNHQzV3NPbjlwc2lHSGJBNklNRzJSR3B1dQoxalFTWDBsMmQ0L0o3ZzhKejdhRDVJT0FadnBEQVZBTVFJNHhUYXVMcjRScFFhbVdoUVpYNW9LTmRVVks5WDNCCm9JdDBuZWo1Y3FjcjgyTzlIb1N3RStINVU4WkVxMnpuSllxY3JMbEhxTzQxYXFaSmRqMGNVWW1INTF2Z043TnMKTmZQSFZsWWR3Mk9HbVNjZ202RDZUZ2YxTXBhdTRwaFFMMlJwcUhyb0JFOW4zTmo3UmU0aE5TbnhtTlh5Z2JONApxck4zWk9xVEs0VGcwOGF4OVBnckhISEgzVmkzcGVLZkkxTDJHUFUrMWg5MWxUWXRncmpFZENqS0JCTzI1ZGNuClJMSHV3bFBzV3EwaEFvSUJBQmFLb2xpd3JsRnJNU1RTRjFMUlNKQnRDNjg4VDlBNTRSSXNEYXVPWG96UmNZR1UKbWF2dGg0ZDJ6Wm55Z0huR2pLdzlmb3JhV1B4V3lBMnAvbWNBVk9JUUZOKyt6clJMN1VtL1RtamVlVHB3U1NDeQpQV2ZmZnJISm1MTjZ6a2E2WHIzZCtpMUlqSFh2Y3ZZMTRKRG1Qb1E3ZzFXN2lJU0FtZDBReGFlUUs5SUp1TzJWCmIwL0s5bjdrRXVzLy9rby8xZ2c0b1dPTERreC9pd1NFMUdoaEVVUjd6MFdBdXhuSk4xSzNHVkcrRndkdHJOOFoKZGZZdEQzL3VZbWkrczE0dWNzZ210WVdsYzQ1bGZ2UW5YamNkVC92dHBGZE9XOW9XUWJJRnZhaFBhOWJjYys0bgpObHFCSEplWlFaR3VZWEhVbzJlc0I0WFRndkpLNFZDc2pjZmZ2MkVDZ2dFQVMyR3JBeXJvSlJyNExQaUo3cEVwCmdXcDFvYkkvOVRlU09lZ3BFd21Lb1h6ZzNrMmxsMm9oaGZJU0ZuSXE3bEoxQ3REVm9UcXhQVmpVMy9OTXF1NTMKcFpLNittUXllMzFmRFliMTJzWWhSbVNPR0tVVExmMGNZNzVaVzdhL0lMTjJmY0ZNVXQ5TURLMjJ6TlY5cXBjbwpIcEU1d0JZRDVQdHg3eGQ5bU51dTE2U0VCbEc4RXpmSXR1OG5jdmF5bUVHQkF5bmtRR0JQV3lLUFdvWUVRL2hjClJOTkVIa1ZVcHhFbTN0eE53MERoK0xlRjJYclg0ODJ6Z2lPRDlUMWJLZWIyRkxqV1FTNmZrV3R4MUNEc2RtY2EKSmVRRzlLbjQ4ZkVPRHprbUJxUzFnd2tIRnRFZnRwSlVDcE9KN0VMVThhL3ZYcU1pbytFMENzclE0OUhZS09kUQpBUUtDQVFCZHQ1WGRmdzh2N1hvVXk5Y2tRS3MwZjY3TzNvb2J6Ym93WHdXaitqdWFKZkYraFdaSlVSRk9yT3ZFCnJRTldnK29JNERQSTAzT3dWVWRZYzVKVndIZHRONHdPRjJ3U1hBU2x0MVUxVjkrb2QwYWtTRzNwOWl4cGVmQW8KNkEwQ3p5cDU3cTNlT0kwODlUVkRlRlRZZzl6RFZvZkthTFFQajVRL0gwaGJ3US9NaFB0KzZVcGpzNHUxVlgrdAovYWtubWJVeTdCSGpVcFpaaVhEeVQyTkNENlRCKytsOHZKWmlKWE12eHJkc3B0M3p5TGovSWhsKzdFMlMrNVluClVuWmtNNmFPQnhLOERHN2xnWC9xMm1MNmtLTnd6ZzljM24xSkFFam5wZzlHNkM3LzMzTnBwajNpTzcwbG5pQksKeThXTWc5YWFlSTV3VVllVzRPZ1ZqTkJQWFd4YQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==
#   splunk-client.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUgzakNDQmNhZ0F3SUJBZ0lDTk9Fd0RRWUpLb1pJaHZjTkFRRUxCUUF3Z1l3eEN6QUpCZ05WQkFZVEFrUkYKTVR3d09nWURWUVFLREROR2FXNWhibm9nU1c1bWIzSnRZWFJwYXlCVVpXTm9ibTlzYjJkcFpTQlRaWEoyYVdObApJRWR0WWtnZ0ppQkRieTRnUzBjeFB6QTlCZ05WQkFNVE5rWnBibUZ1ZWlCSmJtWnZjbTFoZEdscklGUmxZMmh1CmIyeHZaMmxsSUZObGNuWnBZMlVnUmpBMElFTnNZWE56TWlCRFFTQkhNakFlRncweU1EQXpNak15TXpBd01EQmEKRncweU16QXpNak15TWpVNU5UbGFNSUhVTVFzd0NRWURWUVFHRXdKRVJURVFNQTRHQTFVRUNCTUhRbUYyWVhKcApZVEVQTUEwR0ExVUVCeE1HVFhWdWFXTm9NVHd3T2dZRFZRUUtERE5HYVc1aGJub2dTVzVtYjNKdFlYUnBheUJVClpXTm9ibTlzYjJkcFpTQlRaWEoyYVdObElFZHRZa2dnSmlCRGJ5NGdTMGN4RURBT0JnTlZCQXNUQjA5Rk5UVXcKTlRBeEhEQWFCZ05WQkFNVEUwOUZOVFV3TlRBZ1FXeGxjblJ6SUZSbGMzUXhOREF5QmdrcWhraUc5dzBCQ1FFVwpKVnBhVmkxR1NWUlRMVFUxTURVd0xVTnNiM1ZrTFU1aGRHbDJaVUJtTFdrdGRITXVaR1V3Z2dJaU1BMEdDU3FHClNJYjNEUUVCQVFVQUE0SUNEd0F3Z2dJS0FvSUNBUURKY1o1UHVEaHc2VDB3eUxUbXFTNUpLQVlkcVFMUmp0b08KNUg0ZGdGdTZBN0NYT3NXYjh3Tm1PRDhxOXNXZE04bGtuQ1J2VGExMzBNRUZQR3U0Z0hmakFKVkhLbkFDQ3E2Vgo3eFdzcGxRaHM5NElLWFZjTUtQa3o0cFdlTG1qa2VNQitVc1dVQzRGQmJRaUhUSi9sRk1uUmRtNzB5aFVVcmhGCktUdVVkN3JTazN0OEdCcHlSell1L0h6THR2cCttczlsZVlvbU50eE85cTQwdStZRWdqS2pZbnFDcFVTSTR1UFMKeThUdm5hbGNEbUNNWStybnRscTRQUW43RlVCaWROcFlIaktINUEvL0dQclM1N0twaEt5ZWt5SnVyK2FraVRLTApta2prMzM4TlQ3Mk8zcWE0SVpha3dDYnJIT0JObCs5MlFlVVlLV01QNTRGcXNuNnFqTEFaWlhJMDdkSXRTeS84Ci9JSVhEMWljcHBwaHhMbFcvM0xpWk1UakhoZlM0K1VFTDl6VG1RVmhhZGNEbldPMVd3RzA0elEza0VIM2tJV0MKTHlzbWdHbVVLOVhDSWdlRkhDeUdBZThYMGVwR1ZlWHlLbG9rd2FlaURuVlI0ei80cDlqNjZDTk50N2xzV3ZYcApDRnJ5ay91OFhtUU5JZUtreXZUbVhSK0VtblNidTREUE1ZRUU5cFRmSUE1UThMd3F1clNxeTRyWkVTU09ZSWlKClpGc09wRWd4ZkRFRVVEYUl0Vy82YjlXWWI5a01GTVZ2aU5NNGZWS1NiaWh2YU1oTTh5dVFXMERRZEdoMlo4V0YKOXVPMy9XNm1xQ3NDTjhIQUpmQ1VFbTZlU2w2dzMwL0ZHRHdmNU4wR0RXWDR6TDdDSGYwZ2tLdFcrTmlCNy9VegorazNMdTQ5TGtRSURBUUFCbzRJQi9qQ0NBZm93SGdZRFZSMFJCQmN3RllJVFQwVTFOVEExTUNCQmJHVnlkSE1nClZHVnpkREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUhBd0l3Z2VrR0ExVWQKSHdTQjRUQ0IzakNCcUtDQnBhQ0JvcVNCbnpDQm5ERUxNQWtHQTFVRUJoTUNSRVV4UERBNkJnTlZCQW9NTTBacApibUZ1ZWlCSmJtWnZjbTFoZEdscklGUmxZMmh1YjJ4dloybGxJRk5sY25acFkyVWdSMjFpU0NBbUlFTnZMaUJMClJ6RS9NRDBHQTFVRUF4TTJSbWx1WVc1NklFbHVabTl5YldGMGFXc2dWR1ZqYUc1dmJHOW5hV1VnVTJWeWRtbGoKWlNCR01EUWdRMnhoYzNNeUlFTkJJRWN5TVE0d0RBWURWUVFERXdWRFVrd3lPREF4b0MrZ0xZWXJhSFIwY0RvdgpMM0JyYVM1bUxXa3RkSE11WkdVdlkzSnNMMFl3TkVNeVNWb3lMME5TVERJNExtTnliREFkQmdOVkhRNEVGZ1FVClpNMG1ZWllTakREZ1pBUElUWHVQRmxBWFJuOHdId1lEVlIwakJCZ3dGb0FVWVBmRHM5Q2R5UkJPSlVlbDBySmUKZng3OHpnZ3dnWVlHQTFVZElBUi9NSDB3ZXdZTkt3WUJCQUdCdGwwQkFnRUJBVEJxTUNVR0NDc0dBUVVGQndJQgpGaGxvZEhSd09pOHZjR3RwTG1ZdGFTMTBjeTVrWlM5amNITXZNRUVHQ0NzR0FRVUZCd0lDTURVTU0wWnBibUZ1CmVpQkpibVp2Y20xaGRHbHJJRlJsWTJodWIyeHZaMmxsSUZObGNuWnBZMlVnUjIxaVNDQW1JRU52TGlCTFJ6QU4KQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBV2wyQXkvWmJubWxNaGJsM1ZuL0xQZ1M3WFozOEh4aUtiU290ckFRZQpERXdTSEFGdi94aEUwNEh0T09Ga1ZMNkVWUklab0xtaWtaQk92dXpJQjBlVzlCcTV5MjZjMzFNUDJyMTZudVJRCnVCZEFxN0gyNHpUSmZRaGp4dDNYQkppUzFOb3lZM2x4cm5aRDBZcUx1SU9PdGFwZW92SStMU000ME9qU2lxTWsKNDJUVVBsSk4zbzJOSmhPK1VBbDhmK3IzYjRoNkpvd2U4L3JvWmdicHg4SUlFbmNxM3VFUW1wMW9qUWtTbVFHUQpoRU9Yb2pUN3FSck5sZFh5Y0Z0aFBWQS9haXdLb0tCYXJ0WjZhclFhRWNXOGZUaGlRMUNYZHBUZnMvT1V6OUF0CjU5eUhtWG5Yc29rYUsxdmpJR3JzMmN5blpLQU52NEE1dXYxWGlGSmY0UUZva2JWcG00U01NaWxFd0haYkFaR0UKY0g4UVBCaUxjT0JpWDRrS0tNZXhsVlN4bTlXcDVyUFdwTUpkdTNNcksvSjRwTXJiSHFkUGltak9IOWhFVGxLTwptRUtvMHYyZUNab3dZQWdlVTFoUCs0ajV2NkFMd0lvR01rb2hnWGZEbzBUTGphYjBTQkx0bGYzRlFDUm9jRXliCjdxeFFZQ2NOcHAxVFNRN2E2T0lJTllaQ0U4U1VTdmZhRFlLRlNmUEwrajZHZ25VWno3WHpoR3NaQkx1OFNhNksKbTVYWnVUUFN1b0xtbnEwVWcyVEYrazdwajVtdjVNSVg1SVNwdEJmamVnc0VNenpBWXkxcWVvYkZLN1hDOEpkYQpmVHQyNCszRXdOZVBVSTFBUU4rYjg4RG1YMUZ2aW5EeEVTOEtuRG9ZMk9sTDlOL05EeWc4RTRnR0dXMlEweWt2CjlDZz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==
# kind: Secret
# metadata:
#   name: splunk-audit-webhook-server
#   namespace: kube-system
# type: Opaque
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: splunk-audit-webhook
  namespace: {{ .Release.Namespace }}
  labels:
    k8s-app: splunk-audit-webhook
spec:
  selector:
    matchLabels:
      k8s-app: splunk-audit-webhook
  template:
    metadata:
      labels:
        k8s-app: splunk-audit-webhook
        app: splunk-audit-webhook
        networking.gardener.cloud/to-dns: allowed
        networking.gardener.cloud/to-public-networks: allowed
      annotations:
          scheduler.alpha.kubernetes.io/critical-pod: ''
        spec:
      # it's better to disable the service links as the default args do not work properly otherwise (metal#64)
      # is this still necessary? Not in authn deployment.
      enableServiceLinks: False
      containers:
      - name: splunk-audit-webhook
        image: {{ index .Values.images "auditlog-webhook" }}
        imagePullPolicy: Always
        restartPolicy: Always
        env:
        - name: SPLUNK_AUDIT_WEBHOOK_SERVER_URLS
          value: {{ .Values.auditlogWebhook.splunk-hec-endpoint.url }}
        - name: SPLUNK_AUDIT_WEBHOOK_TOKEN
          value: {{ .Values.auditlogWebhook.splunk-hec-endpoint.token }}
        - name: SPLUNK_AUDIT_WEBHOOK_BIND_ADDR
          value: "0.0.0.0"
        - name: SPLUNK_AUDIT_WEBHOOK_INSECURE_CERT
          value: {{ .Values.auditlogWebhook.accept-insecure-cert }}
        # - name: SPLUNK_AUDIT_WEBHOOK_CLIENT_TLS_KEY
        #   value: /etc/webhook/certs/splunk-client.key
        # - name: SPLUNK_AUDIT_WEBHOOK_CLIENT_TLS_CERT
        #   value: /etc/webhook/certs/splunk-client.crt
        - name: SPLUNK_AUDIT_WEBHOOK_WEBHOOK_TLS_KEY
          value: /etc/webhook/certs/splunk-audit-webhook-server.key
        - name: SPLUNK_AUDIT_WEBHOOK_WEBHOOK_TLS_CERT
          value: /etc/webhook/certs/splunk-audit-webhook-server.crt
        ports:
          - containerPort: {{ .Values.auditlogWebhook.port }}
          protocol: TCP
        volumeMounts:
          - name: webhook-certs
            mountPath: /etc/webhook/certs
            readOnly: true
      volumes:
        - name: webhook-certs
          secret:
            secretName: splunk-audit-webhook-server
---
apiVersion: v1
kind: Service
metadata:
  name: splunk-audit-webhook
  namespace: {{ .Release.Namespace }}
  labels:
    app: splunk-audit-webhook
spec:
  selector:
    app: splunk-audit-webhook
  ports:
  - port: 443
    targetPort: {{ .Values.auditlogWebhook.port }}
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: splunk-audit-webhook-allow-apiserver
  namespace: {{ .Release.Namespace }}
spec:
  podSelector:
    matchLabels:
      app: splunk-audit-webhook
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: kubernetes
          role: apiserver
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: kubeapi2splunk-audit-webhook
spec:
  egress:
  - ports:
    - port: 443
      protocol: TCP
    to:
    - podSelector:
        matchLabels:
          app: splunk-audit-webhook
  podSelector:
    matchLabels:
      app: kubernetes
      role: apiserver
  policyTypes:
  - Egress
{{- end }}
